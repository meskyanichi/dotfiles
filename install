#! /bin/sh

dotfiles_dir="$HOME/.dotfiles"
zshrc_local="$HOME/.zshrc.local"

echo "Creating $HOME/Developer directory"
mkdir -p $HOME/Developer

if [ ! -d $dotfiles_dir ]; then
  echo "Installing dotfiles"
  git clone git@github.com:mrrooijen/dotfiles.git $dotfiles_dir
fi

echo "Linking zsh configuration"
ln -vnfs "$dotfiles_dir/zsh/zshrc" "$HOME/.zshrc"
ln -vnfs "$dotfiles_dir/zsh/zshenv" "$HOME/.zshenv"

echo "Linking emacs configuration"
mkdir -p $HOME/.emacs.d/straight/versions
ln -vnfs "$dotfiles_dir/emacs/init.el" "$HOME/.emacs.d/init.el"
ln -vnfs "$dotfiles_dir/emacs/straight.lock.el" "$HOME/.emacs.d/straight/versions/default.el"

echo "Linking git configuration"
ln -vnfs "$dotfiles_dir/git/gitconfig" "$HOME/.gitconfig"

echo "Linking (ruby) gem configuration"
ln -vnfs "$dotfiles_dir/ruby/gemrc" "$HOME/.gemrc"

echo "Initializing $zshrc_local"
touch $zshrc_local

echo "Installing xcode command-line tools"
xcode-select --install

echo "Installing homebrew"
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

echo "Installing system ruby"
brew install ruby

echo "Installing coreutils, git"
brew install coreutils git

echo "Installing iTerm2"
brew install --cask iterm2

echo "Installing rectangle"
brew install --cask rectangle

echo "Installing Emacs"
brew tap jimeh/emacs-builds
brew install --cask emacs-app
